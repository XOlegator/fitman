var myApp=new Framework7({modalTitle:"Personal trainer",init:!1}),$$=Framework7.$,lang="en",fLang;"ru"===lang?(fLang="./ru.json",console.log("\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u043b\u0438 \u0440\u0443\u0441\u0441\u043a\u0438\u0439 \u044f\u0437\u044b\u043a!")):"en"===lang&&(fLang="./en.json",console.log("\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u043b\u0438 \u0430\u043d\u0433\u043b\u0438\u0439\u0441\u043a\u0438\u0439 \u044f\u0437\u044b\u043a!"));
$$.getJSON(fLang,function(b){console.log("\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u043b\u0438 \u044f\u0437\u044b\u043a\u043e\u0432\u043e\u0439 \u0444\u0430\u0439\u043b!");i18n=new Jed(b);Template7.registerHelper("_",function(a){return i18n.gettext(a)});Template7.registerHelper("ngettext",function(a,b,d){return a+"222"})});Date.prototype.toDateInputValue=function(){var b=new Date(this);b.setMinutes(this.getMinutes()-this.getTimezoneOffset());return b.toJSON().slice(0,10)};
var messageDelay=3E3,bdSchema="";
$$.getJSON("default/bd-schema.json",function(b){bdSchema=b;db.open(bdSchema).then(function(a){server=a;console.log("JSON.stringify(server)"+JSON.stringify(server));console.log("\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u043c \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 index-2");myApp.onPageInit("index-2",function(a){server.settings.query().all().execute().then(function(a){console.log("\u041f\u043e\u043b\u0443\u0447\u0438\u043b\u0438 \u0441\u043f\u0438\u0441\u043e\u043a \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a");a.length?
(console.log("\u0423\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043f\u043e \u0434\u0430\u043d\u043d\u044b\u043c \u0431\u0430\u0437\u044b: results[0].units = "+a[0].units+"; results[0].language = "+a[0].language),$$("#selectUnits").val(a[0].units),$$("#selectLang").val(a[0].language)):server.settings.add({units:"metric",language:"english"}).then(function(a){console.log("\u0417\u0430\u043f\u0438\u0441\u0430\u043b\u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043f\u043e-\u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0432 \u0431\u0430\u0437\u0443: "+
JSON.stringify(a));$$("#selectUnits").val("metric");$$("#selectLang").val("english")})})});console.log("\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u043c \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 index-3");myApp.onPageInit("index-3",function(a){server.customers.query("name").all().execute().then(function(a){console.log("\u0424\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u043c \u0441\u043f\u0438\u0441\u043e\u043a \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432");
updateListCustomers(a)})});console.log("\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u043c \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 index-5");myApp.onPageInit("index-5",function(a){server.exerciseType.query("name").all().execute().then(function(a){console.log("\u0424\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u043c \u0441\u043f\u0438\u0441\u043e\u043a \u0433\u0440\u0443\u043f\u043f \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u0439");updateListExerciseType(a)})});
myApp.onPageInit("index-10",function(a){$$("#inputDateStartClasses").val((new Date).toDateInputValue())});myApp.init();console.log("\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 myApp");$$(".app-text").each(function(){console.log("\u041f\u0435\u0440\u0435\u0432\u043e\u0434\u0438\u043c \u043e\u0447\u0435\u0440\u0435\u0434\u043d\u0443\u044e \u0441\u0442\u0440\u043e\u043a\u0443");var a=
Template7.compile($$(this).text())();$$(this).text(a)})})});
$$("#selectUnits").on("change",function(){console.log("\u0417\u0430\u0448\u043b\u0438 \u0432 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a \u0435\u0434\u0438\u043d\u0438\u0446 \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u044f: "+JSON.stringify($$(this).val()));server.settings.query().all().execute().then(function(b){console.log("\u041e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u043c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u0439");var a=
b[0].language,c=$$("#selectUnits").val();console.log("\u041d\u043e\u0432\u0430\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u0439: "+c);server.settings.update({id:parseInt(b[0].id),units:c,language:a}).then(function(a){console.log("\u0417\u0430\u043f\u0438\u0441\u0430\u043b\u0438 \u043d\u043e\u0432\u044b\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0432 \u0431\u0430\u0437\u0443: "+JSON.stringify(a))})})});
$$("#selectLang").on("change",function(){console.log("\u0417\u0430\u0448\u043b\u0438 \u0432 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a \u044f\u0437\u044b\u043a\u0430");server.settings.query().all().execute().then(function(b){var a=$$("#selectLang").val();console.log("\u041d\u043e\u0432\u044b\u0439 \u044f\u0437\u044b\u043a \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430: "+a);var c=b[0].units;server.settings.update({id:parseInt(b[0].id),
units:c,language:a}).then(function(a){console.log("\u0417\u0430\u043f\u0438\u0441\u0430\u043b\u0438 \u043d\u043e\u0432\u044b\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0432 \u0431\u0430\u0437\u0443: "+JSON.stringify(a))})})});
$$(".confirm-fill-demo").on("click",function(){myApp.confirm("Are you sure? It will erase all of your data!",function(){console.log(JSON.stringify(server));server.clear("workExercise");server.clear("schedule");server.clear("workout");server.clear("optionsExercises");server.clear("exercise");server.clear("exerciseType");server.clear("customers");console.log("\u041d\u0430\u0447\u0438\u043d\u0430\u0435\u043c \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0442\u044c \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u044f");
$$.getJSON("default/exercises.json",function(b){for(var a in b.exerciseType)server.exerciseType.add({id:b.exerciseType[a].id,name:b.exerciseType[a].name}).then(function(a){for(var d in b.exerciseType[parseInt(a[0].id)].exercises){var k=b.exerciseType[parseInt(a[0].id)].exercises[d].name,e=parseInt(b.exerciseType[parseInt(a[0].id)].exercises[d].id);server.exercise.add({id:e,name:k,type:parseInt(a[0].id)}).then(function(a){})}for(var f in b.exerciseType[parseInt(a[0].id)].exercises)for(var g in b.exerciseType[parseInt(a[0].id)].exercises[f].options[0])b.exerciseType[parseInt(a[0].id)].exercises[f].options[0][g]&&
(e=b.exerciseType[parseInt(a[0].id)].exercises[f].id,server.optionsExercises.add({option:g,exerciseId:e}).then(function(a){console.log("\u0414\u043e\u0431\u0430\u0432\u0438\u043b\u0438 \u0432 \u0411\u0414 \u043d\u043e\u0432\u0443\u044e \u0441\u0432\u044f\u0437\u043a\u0443 \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u044f \u0441 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u043c \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u043c: "+JSON.stringify(a))}))});server.exerciseType.query("name").all().distinct().execute().then(function(a){updateListExerciseType(a)})});
$$.getJSON("default/customers.json",function(b){for(var a in b.customers)server.customers.add(b.customers[a]);server.customers.query("name").all().distinct().execute().then(function(a){updateListCustomers(a)})});myApp.alert("Enjoy your new demo data")})});
$$(".confirm-clean-db").on("click",function(){myApp.confirm(i18n.gettext("Are you sure? It will erase all of your data!"),function(){console.log("Start cleaning DB");server.clear("settings");server.clear("workExercise");server.clear("schedule");server.clear("workout");server.clear("optionsExercises");server.clear("exerciseType");server.clear("exercise");server.clear("customers");console.log("Reload pages data");updateListCustomers("");updateListExerciseType("");myApp.alert(i18n.gettext("Database is clean"))},
function(){})});$$(".confirm-create-db").on("click",function(){myApp.confirm(i18n.gettext("Are you sure?"),function(){db.open(bdSchema).then(function(b){server=b})})});$$(".confirm-remove-db").on("click",function(){myApp.confirm(i18n.gettext("Are you sure?"),function(){indexedDB.deleteDatabase("my-app");document.getElementById("ulListCustomers").innerHTML="";document.getElementById("forDeleteCustomers").innerHTML="";document.getElementById("ulListExerciseType").innerHTML=""})});
function emptyDataCustomer(){var b="",b='<a href="#view-3" class="tab-link btn-left-top app-text">'+i18n.gettext("Cancel")+"</a></a>",b=b+('<a href="" class="tab-link btn-right-top app-text" style="display: none;" id="linkEditCustomer" onclick="addCustomer()">'+i18n.gettext("Save")+"</a>");document.getElementById("divEditCustomer").innerHTML=b;$$("#inputNewCustomer").val("");$$("#inputNewCustomer").attr("data-item","");$$("#newCustomerComments").val("")}
function emptyDataExercise(){var b="",b='<a href="#view-7" class="tab-link btn-left-top app-text">'+i18n.gettext("Cancel")+"</a></a>",b=b+('<a href="" class="tab-link btn-right-top app-text" onclick="addExercise()">'+i18n.gettext("Save")+"</a>");document.getElementById("divAddExercise").innerHTML=b;$$("#inputNewExercise").val("");$$("#view-7a input").prop("checked",!1)}
function updateListCustomers(b){var a="",c="",d;for(d in b)value=b[d],a+="<li>",a+='  <a href="#view-10" class="tab-link item-link item-content" onclick="fillCustomerData('+value.id+')">',a+='    <div class="item-inner">',a+='      <div class="item-title">'+value.name+"</div>",a+="    </div>",a+="  </a>",a+="</li>",c+="<li>",c+='  <label class="label-checkbox item-content">',c+='    <div class="item-inner">',c+='      <div class="item-title">',c+='        <a href="#view-10" class="tab-link btn-right-top" onclick="fillCustomerData('+
value.id+')">'+value.name+"</a>",c+="      </div>",c+="    </div>",c+='    <input type="checkbox" name="inputCustomerForDelete" value="'+value.id+'">',c+='    <div class="item-media item-media-right">',c+='      <i class="icon icon-form-checkbox"></i>',c+="    </div>",c+="  </label>",c+="</li>";document.getElementById("ulListCustomers").innerHTML=a;document.getElementById("forDeleteCustomers").innerHTML=c;document.getElementById("badgeCountCustomers").innerHTML=b.length}
function addCustomer(){var b=$$("input#inputNewCustomer").val(),a=b.replace(/<script[^>]*>[\S\s]*?<\/script[^>]*>/ig,""),b="",b=$$("input#inputDateStartClasses").val();b.replace(/<script[^>]*>[\S\s]*?<\/script[^>]*>/ig,"");var c="somepic"+(new Date).toISOString()+".jpg",b="",b=$$("textarea#newCustomerComments").val(),b=b.replace(/<script[^>]*>[\S\s]*?<\/script[^>]*>/ig,"");""!=a?(server.customers.add({name:a,photo:c,comments:b}),server.customers.query("name").all().distinct().execute().then(function(a){myApp.addNotification({title:i18n.gettext("Add new Customer"),
hold:messageDelay,message:i18n.gettext("Data was saved")});updateListCustomers(a)})):myApp.addNotification({title:i18n.gettext("Error while adding"),hold:messageDelay,message:i18n.gettext("Nothing to add!")})}
function editCustomer(){var b=parseInt($$("#inputNewCustomer").data("item")),a=$$("#inputNewCustomer").val(),c=a.replace(/<script[^>]*>[\S\s]*?<\/script[^>]*>/ig,""),a="",a=$$("#newCustomerComments").val(),d=a.replace(/<script[^>]*>[\S\s]*?<\/script[^>]*>/ig,"");console.log("\u0421\u0435\u0439\u0447\u0430\u0441 \u0431\u0443\u0434\u0435\u043c \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u043e \u043a\u043b\u0438\u0435\u043d\u0442\u0443 \u0441 id = "+b);
server.customers.get(b).then(function(a){c===a.name&&d===a.comments?myApp.addNotification({title:i18n.gettext("Nothing to save"),hold:messageDelay,message:i18n.gettext("New data already exist in database.")}):server.customers.update({id:b,name:c,comments:d,photo:a.photo}).then(function(a){console.log("\u041e\u0431\u043d\u043e\u0432\u0438\u043b\u0438 \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u043e \u043a\u043b\u0438\u0435\u043d\u0442\u0443: "+JSON.stringify(a));myApp.addNotification({title:i18n.gettext("Successful updated"),
hold:messageDelay,message:i18n.gettext("Data was updated.")})})})}
function removeCustomers(){myApp.confirm(i18n.gettext("Are you sure?"),function(){$$('input[name="inputCustomerForDelete"]:checked').each(function(){console.log("\u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0441 id = "+this.value);server.customers.get(parseInt(this.value)).then(function(b){console.log("\u041d\u0430\u0448\u043b\u0438 \u0443\u0434\u0430\u043b\u044f\u0435\u043c\u043e\u0433\u043e \u043a\u043b\u0438\u0435\u043d\u0442\u0430 \u0432 \u0431\u0430\u0437\u0435: "+JSON.stringify(b));
console.log("resCustomer.id = "+b.id);server.workExercise.query().filter("customer",parseInt(b.id)).execute().then(function(a){a.length?myApp.addNotification({title:i18n.gettext("Customer ")+b.name+i18n.gettext(" can not be deleted"),hold:messageDelay,message:i18n.gettext("There is data in history.")}):server.schedule.query().filter("customer",parseInt(b.id)).execute().then(function(a){a.length?myApp.addNotification({title:i18n.gettext("Customer ")+b.name+i18n.gettext(" can not be deleted"),hold:messageDelay,
message:i18n.gettext("There is data in schedule by that customer.")}):server.workout.query().filter("customer",parseInt(b.id)).execute().then(function(a){a.length?myApp.addNotification({title:i18n.gettext("Customer ")+b.name+i18n.gettext(" can not be deleted"),hold:messageDelay,message:i18n.gettext("There is data in workout.")}):server.remove("customers",parseInt(b.id)).then(function(a){console.log("\u0423\u0434\u0430\u043b\u0438\u043b\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0441 id = "+
b.id);console.log(JSON.stringify(a));server.customers.query("name").all().distinct().execute().then(function(a){console.log("\u041a\u043b\u0438\u0435\u043d\u0442\u044b \u043f\u043e\u0441\u043b\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f res2 = "+JSON.stringify(a));updateListCustomers(a)})})})})})})})},function(){})}
function fillCustomerData(b){var a="",a='<a href="#view-3" class="tab-link btn-left-top app-text">'+i18n.gettext("Cancel")+"</a></a>",a=a+('<a href="" class="tab-link btn-right-top" style="display: none;" id="linkEditCustomer" onclick="editCustomer()">'+i18n.gettext("Save")+"</a>");document.getElementById("divEditCustomer").innerHTML=a;console.log("\u0417\u0430\u043f\u043e\u043b\u043d\u044f\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u043e \u043a\u043b\u0438\u0435\u043d\u0442\u0443 \u0441 id = "+
b);server.customers.get(parseInt(b)).then(function(a){$$("input#inputNewCustomer").val(a.name);$$("#inputNewCustomer").attr("data-item",b);$$("textarea#newCustomerComments").val(a.comments)})}function showEditLinkCustomer(){console.log("\u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u043c \u043a\u043d\u043e\u043f\u043a\u0443 Update");$$("#linkEditCustomer").show()}
function updateListExerciseType(b){var a="",c;for(c in b)value=b[c],a+="<li>",a+='  <div class="item-content">',a+='    <div class="item-inner">',a+='      <div class="item-media">',a+='        <a href="#view-7" class="tab-link" onclick="updateListExercises('+value.id+')"><i class="icon icon-form-settings"></i></a>',a+="      </div>",a+='      <div class="item-input">',a+='        <input type="text" placeholder="Exercise type" id="ex-compl-name-'+value.id+'" value="'+value.name+'" oninput="showRenameLinkExType('+
value.id+')">',a+="      </div>",a+='      <div class="item-input hidden" id="ex-compl-rename-'+value.id+'">',a+='        <a href="" class="button button-round" onclick="renameExType('+value.id+')">Rename</a>',a+="      </div>",a+='      <div class="item-input hidden" id="ex-compl-'+value.id+'">',a+='        <a href="" class="button button-round" onclick="deleteExType('+value.id+')">Delete</a>',a+="      </div>",a+='      <div class="item-media">',a+='        <label class="label-checkbox item-content">',
a+='          <input type="checkbox" name="ex-compl-'+value.id+'" class="btn-delete-toggle">',a+='          <div class="item-media">',a+='            <i class="icon icon-form-checkbox"></i>',a+="          </div>",a+="        </label>",a+="      </div>",a+="    </div>",a+="  </div>",a+="</li>";document.getElementById("ulListExerciseType").innerHTML=a}function showRenameLinkExType(b){$$("#ex-compl-rename-"+b).hasClass("hidden")&&$$("#ex-compl-rename-"+b).removeClass("hidden")}
function renameExType(b){var a=document.getElementById("ex-compl-name-"+b).value.replace(/<script[^>]*>[\S\s]*?<\/script[^>]*>/ig,"");server.exerciseType.update({id:parseInt(b),name:a}).then(function(a){console.log("\u041f\u0435\u0440\u0435\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u043d\u0430\u044f \u0433\u0440\u0443\u043f\u043f\u0430 \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u0439 \u0432 \u0431\u0430\u0437\u0435: "+JSON.stringify(a));$$("#ex-compl-rename-"+b).hasClass("hidden")||
$$("#ex-compl-rename-"+b).addClass("hidden");myApp.addNotification({title:i18n.gettext("Successful rename"),hold:messageDelay,message:i18n.gettext("Group of exercises was renamed.")})})}
function updateListExercises(b){server.exerciseType.get(b).then(function(a){$$("div.ex-of-type").text(a.name);$$("div.ex-of-type").attr("data-item",b)});var a="";server.exercise.query("name").filter("type",parseInt(b)).execute().then(function(c){console.log("\u041d\u0430\u0439\u0434\u0435\u043d\u043d\u044b\u0435 \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u044f \u043f\u043e \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u043c\u0443 id "+b+" \u0433\u0440\u0443\u043f\u043f\u044b \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u0439: results = "+
JSON.stringify(c));for(var d in c)rowExercise=c[d],a+="<li>",a+='  <div class="item-content">',a+='    <div class="item-inner">',a+='      <div class="item-input">',a+='        <input type="text" placeholder="Exercise" id="ex-name-'+rowExercise.id+'" value="'+rowExercise.name+'" oninput="showRenameLinkExercise('+rowExercise.id+')">',a+="      </div>",a+='      <div class="item-input hidden" id="ex-rename-'+rowExercise.id+'">',a+='        <a href="" class="button button-round" onclick="renameExercise('+
rowExercise.id+')">Rename</a>',a+="      </div>",a+='      <div class="item-media">',a+='        <a href="#view-8" class="tab-link button button-round" onclick="updateViewExProp('+rowExercise.id+')">Properties</a>',a+="      </div>",a+='      <div class="item-input hidden" id="ex-'+rowExercise.id+'">',a+='        <a href="" class="button button-round" onclick="deleteExercise('+rowExercise.id+')">Delete</a>',a+="      </div>",a+='      <div class="item-media">',a+='        <label class="label-checkbox item-content">',
a+='          <input type="checkbox" name="ex-'+rowExercise.id+'" class="btn-delete-toggle">',a+='          <div class="item-media">',a+='            <i class="icon icon-form-checkbox"></i>',a+="          </div>",a+="        </label>",a+="      </div>",a+="    </div>",a+="  </div>",a+="</li>";document.getElementById("ulListExercises").innerHTML=a})}function showRenameLinkExercise(b){$$("#ex-rename-"+b).hasClass("hidden")&&$$("#ex-rename-"+b).removeClass("hidden")}
function renameExercise(b){var a=document.getElementById("ex-name-"+b).value.replace(/<script[^>]*>[\S\s]*?<\/script[^>]*>/ig,"");console.log("newExName = "+a);server.exercise.get(b).then(function(c){server.exercise.update({id:parseInt(b),name:a,type:c.type}).then(function(a){console.log("\u041f\u0435\u0440\u0435\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u043d\u0430\u044f \u0433\u0440\u0443\u043f\u043f\u0430 \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u0439 \u0432 \u0431\u0430\u0437\u0435: "+
JSON.stringify(a));$$("#ex-rename-"+b).hasClass("hidden")||($$("#ex-rename-"+b).addClass("hidden"),myApp.addNotification({title:i18n.gettext("Successful rename"),hold:messageDelay,message:i18n.gettext("Exercise was renamed.")}))})})}
function addExercise(){var b=$$("input#inputNewExercise").val().replace(/<script[^>]*>[\S\s]*?<\/script[^>]*>/ig,""),a=parseInt($$("div#view-7a div.ex-of-type").data("item"));console.log("\u0412\u044b\u0447\u0438\u0441\u043b\u0438\u043b\u0438 \u0433\u0440\u0443\u043f\u043f\u0443 \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u0439 - \u044d\u0442\u043e "+a);""!=b&&server.exercise.query("name").filter("name",b).execute().then(function(c){c.length?myApp.addNotification({title:i18n.gettext("Can not be added"),
hold:messageDelay,message:i18n.gettext("That name of exercise already exist in database.")}):server.exercise.add({name:b,type:a}).then(function(b){console.log("\u0414\u043e\u0431\u0430\u0432\u0438\u043b\u0438 \u043d\u043e\u0432\u043e\u0435 \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u0435: "+JSON.stringify(b));$$('input[name="checkbox-new-ex-prop"]:checked').each(function(){server.optionsExercises.add({option:this.value,exerciseId:parseInt(b[0].id)}).then(function(a){console.log("\u0414\u043e\u0431\u0430\u0432\u0438\u043b\u0438 \u043d\u043e\u0432\u0443\u044e \u0441\u0432\u044f\u0437\u043a\u0443 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440-\u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u0435: "+
JSON.stringify(a))})});console.log("\u041f\u0435\u0440\u0435\u0434 \u043f\u043e\u0441\u0442\u0440\u043e\u0435\u043d\u0438\u0435\u043c \u0441\u043f\u0438\u0441\u043a\u0430 \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u0439 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c \u0438\u0441\u043a\u043e\u043c\u0443 \u0433\u0440\u0443\u043f\u043f\u0443 - \u044d\u0442\u043e "+a);updateListExercises(a);$$('div.content-block-title a[href="#view-7"]').click()})})}
function deleteExercise(b){server.workExercise.query("exercise").filter("exercise",parseInt(b)).execute().then(function(a){a.length?myApp.addNotification({title:i18n.gettext("Exercise ")+a[0].name+i18n.gettext(" can not be deleted"),hold:messageDelay,message:i18n.gettext("This item can not be delete because of history by this exercise.")}):server.schedule.query("exercise").only(parseInt(b)).count().execute().then(function(c){c?myApp.addNotification({title:i18n.gettext("Exercise ")+a[0].name+i18n.gettext(" can not be deleted"),
hold:messageDelay,message:i18n.gettext("This item can not be delete because there are schedule with this exercise.")}):(console.log("exercise \u0434\u043b\u044f \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f: "+b),server.optionsExercises.query().filter("exerciseId",parseInt(b)).execute().then(function(a){for(var c in a)rowOptEx=a[c],server.remove("optionsExercises",parseInt(rowOptEx.id));server.remove("exercise",parseInt(b)).then(function(){var a=parseInt($$("div#view-7a div.ex-of-type").data("item"));
updateListExercises(a)})}))})})}
function updateViewExProp(b){console.log("\u0424\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u043c \u0441\u043f\u0438\u0441\u043e\u043a \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u044f");$$("#view-8 input").prop("checked",!1);server.exercise.get(b).then(function(a){$$("#ex-prop").html(a.name).attr("data-item",b)});server.optionsExercises.query().filter("exerciseId",b).execute().then(function(a){console.log("\u0421\u043f\u0438\u0441\u043e\u043a \u043d\u0430\u0439\u0434\u0435\u043d\u043d\u044b\u0445 \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a \u043f\u043e \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u044e: "+
JSON.stringify(a));for(var b in a)rowExOpt=a[b],console.log("rowExOpt.option = "+rowExOpt.option),$$('input[name="checkbox-ex-prop"][value="'+rowExOpt.option+'"]').prop("checked",!0)})}
function updateExerciseProperties(){var b=parseInt($$("div#ex-prop").data("item"));console.log("\u0418\u0434\u0451\u0442 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u044f \u0441 id = "+b);var a=[],c=[],d=[],k=[];$$('input[name="checkbox-ex-prop"]:checked').each(function(b,c){a[b]=c.value;console.log("\u0417\u0430\u043d\u0435\u0441\u043b\u0438 \u0432 \u043c\u0430\u0441\u0441\u0438\u0432 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0439 \u043e\u043f\u0446\u0438\u0438: "+
c.value)});server.optionsExercises.query().filter("exerciseId",b).execute().then(function(e){console.log("\u0421\u043f\u0438\u0441\u043e\u043a \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a: "+JSON.stringify(e));e.each(function(b,e){c[e]=b.option;in_array(b.option,a)||(d.push(b.option),server.workExercise.query().filter("option",parseInt(b.option)).execute().then(function(a){a.length?(myApp.addNotification({title:i18n.gettext("Error while deleting"),hold:messageDelay,
message:i18n.gettext("Option ")+b.option+i18n.gettext(" already used in database. It can not be deleted!")}),$$('input[name="checkbox-ex-prop"][value="'+b.option+'"]').prop("checked",!1)):(server.remove("optionsExercises",parseInt(b.id)),console.log("\u0423\u0434\u0430\u043b\u0438\u043b\u0438 \u0441\u0432\u044f\u0437\u043a\u0443 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440-\u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u0435 \u0441 id = "+b.id))}))});for(var f in a)in_array(a[f],c)||(k.push(a[f]),
server.optionsExercises.add({option:a[f],exerciseId:b}).then(function(a){console.log("\u0414\u043e\u0431\u0430\u0432\u0438\u043b\u0438 \u0441\u0432\u044f\u0437\u043a\u0443 \u043e\u043f\u0446\u0438\u044f-\u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u0435: "+JSON.stringify(a))}));d.length||k.length||myApp.addNotification({title:i18n.gettext("Nothing to save"),hold:messageDelay,message:i18n.gettext("New set of options are equal to existent.")})})}
function addExType(){var b=$$("input#inputNewExType").val().replace(/<script[^>]*>[\S\s]*?<\/script[^>]*>/ig,"");server.exerciseType.add({name:b}).then(function(a){server.exerciseType.query("name").all().distinct().execute().then(function(a){updateListExerciseType(a)});$$('a[href="#view-5"]').click()})}
function deleteExType(b){server.exercise.query("type").only(b).count().execute().then(function(a){a?myApp.addNotification({title:i18n.gettext("Can not be deleted"),hold:messageDelay,message:i18n.gettext("This item can not be delete while there are exercises in it.")}):server.remove("exerciseType",parseInt(b)).then(function(a){server.exerciseType.query("name").all().distinct().execute().then(function(a){updateListExerciseType(a)})})})}
$$(document).on("change",".btn-delete-toggle",function(){var b="#"+$$(this).attr("name");$$(b).toggleClass("hidden")});
function upgradeViewWorkout(){var b="",b='<div class="col-25">'+('  <center><a href="#view-10" class="back tab-link" id="aCancelSetEx">'+i18n.gettext("Cancel")+"</a></center>"),b=b+'</div><div class="col-25">',b=b+('  <center><a href="#tab1" class="tab-link" onclick="makeCalendExCustomer()">'+i18n.gettext("Calendar")+"</a></center>"),b=b+"</div>",b=b+'<div class="col-25">',b=b+('  <center><a href="#tab2" class="tab-link" onclick="makeScheduleExCustomer()">'+i18n.gettext("Schedule")+"</a></center>"),
b=b+"</div>",b=b+'<div class="col-25">',b=b+('  <center><a href="#tab3" class="tab-link" onclick="makeSetExCustomer()">'+i18n.gettext("Change")+"</a></center>"),b=b+"</div>";document.getElementById("divMenuWorkout").innerHTML=b;var a=0,b=$$("input#inputNewCustomer").val().replace(/<script[^>]*>[\S\s]*?<\/script[^>]*>/ig,""),c=parseInt($$("#inputNewCustomer").data("item"));$$("#spanCustName").html(b).attr("data-item",c);var d=(new Date).toDateInputValue();$$("#spanDateEx").html(d);console.log("\u041a\u043b\u0438\u0435\u043d\u0442 "+
b+", \u0434\u0430\u0442\u0430 "+d);server.workout.query().filter(function(a){return a.date===d&&a.customer===c}).execute().then(function(b){var d="";if(b.length){console.log("\u041d\u0430\u0448\u043b\u0438 \u0432 \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u043e \u0437\u0430\u043d\u044f\u0442\u0438\u044f\u043c \u043d\u0430 \u0441\u0435\u0433\u043e\u0434\u043d\u044f: "+JSON.stringify(b));for(var f in b){var g=b[f];console.log("\u041e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u043c \u043f\u0435\u0440\u0432\u043e\u0435 \u0437\u0430\u043d\u044f\u0442\u0438\u0435 \u043d\u0430 \u0441\u0435\u0433\u043e\u0434\u043d\u044f. item = "+
JSON.stringify(g));server.exercise.get(g.exercise).then(function(a){console.log("\u0412\u043e\u0442, \u0447\u0442\u043e \u043d\u0430\u0448\u043b\u0438 \u043f\u043e \u0442\u0435\u043a\u0443\u0449\u0435\u043c\u0443 \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u044e: "+JSON.stringify(a));var b=a.name;d+="<li>";d+='  <a href="#view-24" class="tab-link item-link item-content" onclick="makeViewExWork('+a.id+')">';d+='    <div class="item-inner">';d+='      <span data-item="'+a.id+'">'+b+"</span>";
d+="    </div>";d+="  </a>";d+="</li>";console.log("\u0421\u0435\u0439\u0447\u0430\u0441 \u0431\u0443\u0434\u0435\u043c \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u044c \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0439 \u0441\u043f\u0438\u0441\u043e\u043a \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u0439");$$("#noWorkout").hide();document.getElementById("ulListCurrentExercises").innerHTML=d});a=1}}else console.log("\u0421\u0435\u0433\u043e\u0434\u043d\u044f \u043a\u043e\u043c\u043f\u043b\u0435\u043a\u0441 \u0437\u0430\u043d\u044f\u0442\u0438\u0439 \u043d\u0435 \u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043b\u0441\u044f, \u0437\u043d\u0430\u0447\u0438\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u043c \u043f\u043e \u0434\u043d\u044f\u043c \u043d\u0435\u0434\u0435\u043b\u0438"),
server.schedule.query().filter("customer",c).execute().then(function(b){if(b.length){console.log("\u041d\u0430\u0448\u043b\u0438 \u0432 \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u043e \u0437\u0430\u043d\u044f\u0442\u0438\u044f\u043c \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u043a\u043b\u0438\u0435\u043d\u0442\u0430 \u043f\u043e \u0434\u043d\u044f\u043c \u043d\u0435\u0434\u0435\u043b\u0438");switch((new Date).getDay()){case 0:nameToday="sunday";break;case 1:nameToday="monday";
break;case 2:nameToday="tuesday";break;case 3:nameToday="wednesday";break;case 4:nameToday="thursday";break;case 5:nameToday="friday";break;case 6:nameToday="saturday"}console.log("\u0421\u0435\u0433\u043e\u0434\u043d\u044f: "+nameToday);for(var c in b)if(g=b[c],g.day===nameToday||"everyday"===g.day)server.exercise.get(g.exercise).then(function(a){var b=a.name;d+="<li>";d+='  <a href="#view-24" class="tab-link item-link item-content" onclick="makeViewExWork('+a.id+')">';d+='    <div class="item-inner">';
d+='      <span data-item="'+a.id+'">'+b+"</span>";d+="    </div>";d+="  </a>";d+="</li>";console.log("\u0421\u0435\u0439\u0447\u0430\u0441 \u0431\u0443\u0434\u0435\u043c \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u044c \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0439 \u0441\u043f\u0438\u0441\u043e\u043a \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u0439");$$("#noWorkout").hide();document.getElementById("ulListCurrentExercises").innerHTML=d}),a=1}});a||
$$("#noWorkout").show()});myApp.showTab("#tab0")}function in_array(b,a){for(var c=0;c<a.length;c++)if(a[c]==b)return!0;return!1}
function makeSetExCustomer(){var b="",b='<div class="col-25">'+('  <center><a href="" class="tab-link" onclick="makeSetExCustomer()" id="aClearAll">'+i18n.gettext("Clear all")+"</a></center>"),b=b+'</div><div class="col-25">',b=b+('  <center><a href="#tab1" class="tab-link" onclick="makeCalendExCustomer()">'+i18n.gettext("Calendar")+"</a></center>"),b=b+"</div>",b=b+'<div class="col-25">',b=b+('  <center><a href="#tab2" class="tab-link" onclick="makeScheduleExCustomer()">'+i18n.gettext("Schedule")+
"</a></center>"),b=b+"</div>",b=b+'<div class="col-25">',b=b+('  <center><a href="#tab0" class="tab-link" onclick="saveSetExCustomer(\'fromChange\')">'+i18n.gettext("Save")+"</a></center>"),b=b+"</div>";document.getElementById("divMenuWorkout").innerHTML=b;$$("#ulListSelectedExercises").html("");var a="",c=[];$$("#ulListCurrentExercises li a div span").each(function(b,k){temp=k.innerHTML;console.log("\u0420\u0430\u0437\u0431\u043e\u0440 \u043e\u0447\u0435\u0440\u0435\u0434\u043d\u043e\u0439 \u043f\u043e\u0437\u0438\u0446\u0438\u0438 \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u044f: "+
JSON.stringify($$(this)));exercise=temp.replace(/<script[^>]*>[\S\s]*?<\/script[^>]*>/ig,"");var e=parseInt($$(this).data("item"));c[b]=exercise;console.log("exercise = "+exercise);a+='<li class="swipeout swipeout-selected">';a+='  <div class="swipeout-content item-content">';a+='    <div class="item-inner">';a+='      <div class="item-title set-of-exercises" data-item="'+e+'">'+exercise+"</div>";a+="    </div>";a+="  </div>";a+='  <div class="swipeout-actions-left">';a+='    <a href="#" class="action1">Deleted</a>';
a+="  </div>";a+="</li>"});$$("ul#ulListSelectedExercises").append(a);$$("#ulListAllExWithTypes").html("");server.exerciseType.query("name").all().execute().then(function(a){console.log("\u0424\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u043c \u0441\u043f\u0438\u0441\u043e\u043a \u0433\u0440\u0443\u043f\u043f \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u0439");for(var b in a){var e=a[b].id,f=a[b].name;console.log("\u0422\u0435\u043a\u0443\u0449\u0430\u044f \u0433\u0440\u0443\u043f\u043f\u0430 \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u0439: "+
f+" \u0441 id = "+e);$$("#ulListAllExWithTypes").append('<li class="item-divider" data-item="'+e+'">'+f+"</li>");console.log("\u0414\u043e\u0431\u0430\u0432\u0438\u043b\u0438 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043e\u0447\u0435\u0440\u0435\u0434\u043d\u043e\u0439 \u0433\u0440\u0443\u043f\u043f\u044b \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u0439: "+f+" \u0441 id = "+e);server.exercise.query("name").filter("type",parseInt(e)).execute().then(function(a){for(var b in a){var d=
a[b].id,e=a[b].name,k=a[b].type;if(!in_array(e,c)){console.log("\u041f\u0440\u043e\u0432\u0435\u0440\u0438\u043b\u0438, \u0447\u0442\u043e \u044d\u0442\u043e\u0433\u043e \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u044f \u043d\u0435\u0442 \u0432 \u0441\u043f\u0438\u0441\u043a\u0435 \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439: "+e);var h="",h=h+'<li class="swipeout swipeout-all">',h=h+'  <div class="swipeout-content item-content">',h=h+'    <div class="item-inner">',h=h+
('      <div class="item-title" data-item="'+d+'">'+e+"</div>"),h=h+"      </div>",h=h+"    </div>",h=h+"  </div>",h=h+'  <div class="swipeout-actions-right">',h=h+'    <a href="#" class="action1">Added</a>',h=h+"  </div>",h=h+"</li>";$$("#ulListAllExWithTypes").find('li.item-divider[data-item="'+k+'"]').append(h)}}a.length=0})}})}
$$(document).on("opened",".swipeout-all",function(b){console.log("Item opened");myApp.swipeoutDelete(this);console.log($$(this).find("div.item-title").text());b=$$(this).find("div.item-title").text();var a="",c=$$(this).find("div.item-title").data("item");console.log("\u041e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u043b\u0438 id \u0441\u0432\u0430\u0439\u043f\u043d\u0443\u0442\u043e\u0433\u043e \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u044f: "+c);a+='<li class="swipeout swipeout-selected">  <div class="swipeout-content item-content">';
a+='    <div class="item-inner">';a+='      <div class="item-title set-of-exercises" data-item="'+c+'">'+b+"</div>";a+="    </div>";a+="  </div>";a+='  <div class="swipeout-actions-left">';a+='    <a href="#" class="action1">Deleted</a>';a+="  </div>";a+="</li>";$$("ul#ulListSelectedExercises").append(a)});
$$(document).on("opened",".swipeout-selected",function(b){myApp.swipeoutDelete(this);console.log($$(this).find("div.item-title").text());b=$$(this).find("div.item-title").text();var a="",c=parseInt($$(this).find("div.item-title").data("item")),a=a+'<li class="swipeout swipeout-all">',a=a+'  <div class="swipeout-content item-content">',a=a+'    <div class="item-inner">',a=a+('      <div class="item-title" data-item="'+c+'">'+b+"</div>"),a=a+"      </div>",a=a+"    </div>",a=a+'    <div class="swipeout-actions-right">',
a=a+'      <a href="#" class="action1">Added</a>',a=a+"    </div>",a=a+"  </div>",a=a+"</li>";server.exercise.get(c).then(function(b){console.log("\u041d\u0430\u0448\u043b\u0438 \u0433\u0440\u0443\u043f\u043f\u0443 \u044d\u0442\u043e\u0433\u043e \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u044f: "+b.type);$$("#ulListAllExWithTypes").find('li.item-divider[data-item="'+b.type+'"]').append(a)})});
function saveSetExCustomer(b){var a="",a='<div class="col-25">'+('  <center><a href="#view-10" class="back tab-link" id="aCancelSetEx">'+i18n.gettext("Cancel")+"</a></center>"),a=a+'</div><div class="col-25">',a=a+('  <center><a href="#tab1" class="tab-link" onclick="makeCalendExCustomer()">'+i18n.gettext("Calendar")+"</a></center>"),a=a+"</div>",a=a+'<div class="col-25">',a=a+('  <center><a href="#tab2" class="tab-link" onclick="makeScheduleExCustomer()">'+i18n.gettext("Schedule")+"</a></center>"),
a=a+"</div>",a=a+'<div class="col-25">',a=a+('  <center><a href="#tab3" class="tab-link" onclick="makeSetExCustomer()">'+i18n.gettext("Change")+"</a></center>"),a=a+"</div>";document.getElementById("divMenuWorkout").innerHTML=a;console.log("\u0421\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c \u043d\u0430\u0431\u043e\u0440");var c="",d="",k=parseInt($$("span#spanCustName").data("item")),e=$$("span#spanDateEx").text();server.workout.query().filter(function(a){return a.date===e&&a.customer===k}).execute().then(function(a){console.log("\u041d\u0430\u0448\u043b\u0438 \u0432 \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u043e \u0437\u0430\u043d\u044f\u0442\u0438\u044f\u043c \u043d\u0430 \u0441\u0435\u0433\u043e\u0434\u043d\u044f: "+
JSON.stringify(a));for(var b in a){var c=typeEx[b];server.remove("workout",parseInt(c.id)).then(function(a){console.log("\u0423\u0434\u0430\u043b\u0438\u043b\u0438 workout \u0441 id = "+c.id);console.log(JSON.stringify(a))})}});"fromCalendar"===b?$$("#ulListPastExercises li span").each(function(a,b){c=b.innerHTML;var l=c.replace(/<script[^>]*>[\S\s]*?<\/script[^>]*>/ig,"");console.log("exerciseName = "+l+"; customerId = "+k+"; dateEx = "+e);console.log("\u0421\u043c\u043e\u0442\u0440\u0438\u043c \u0432 html \u0432 \u043f\u043e\u0438\u0441\u043a\u0430\u0445 id \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u044f: "+
$$(this).data("item"));var m=parseInt($$(this).data("item"));server.workout.add({customer:k,date:e,exercise:m});d+="<li>";d+='  <a href="#view-24" class="tab-link item-link item-content" onclick="makeViewExWork('+m+')">';d+='    <div class="item-inner">';d+='      <span data-item="'+m+'">'+l+"</span>";d+="    </div>";d+="  </a>";d+="</li>";document.getElementById("ulListCurrentExercises").innerHTML=d}):$$("div.set-of-exercises").each(function(a,b){c=b.innerHTML;exerciseName=c.replace(/<script[^>]*>[\S\s]*?<\/script[^>]*>/ig,
"");console.log("exerciseName = "+exerciseName+"; customerId = "+k+"; dateEx = "+e);console.log("\u0421\u043c\u043e\u0442\u0440\u0438\u043c \u0432 html \u0432 \u043f\u043e\u0438\u0441\u043a\u0430\u0445 id \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u044f: "+$$(this).data("item"));var l=parseInt($$(this).data("item"));server.workout.add({customer:k,date:e,exercise:l});d+="<li>";d+='  <a href="#view-24" class="tab-link item-link item-content" onclick="makeViewExWork('+l+')">';d+='    <div class="item-inner">';
d+='      <span data-item="'+l+'">'+exerciseName+"</span>";d+="    </div>";d+="  </a>";d+="</li>";document.getElementById("ulListCurrentExercises").innerHTML=d});$$("#noWorkout").hide()}
function makeViewExWork(b){console.log("\u041f\u043e\u0434\u0433\u043e\u0442\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c \u043a \u0440\u0430\u0431\u043e\u0442\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u044f \u0441 id = "+b);parseInt($$("#spanCustName").data("item"));var a=$$("#spanCustName").html().replace(/<script[^>]*>[\S\s]*?<\/script[^>]*>/ig,"");document.getElementById("spanWorkCustName").innerHTML=a;a=(new Date).toDateInputValue();
document.getElementById("spanWorkDateEx").innerHTML=a;server.exercise.get(b).then(function(a){document.getElementById("spanExWork").innerHTML=a.name;$$("#spanExWork").attr("data-item",b)});var c="",c=c+"<li>",c=c+'  <div class="item-content">',c=c+'    <div class="item-media"><i class="icon icon-form-settings"></i></div>',c=c+'    <div class="item-inner">',c=c+'      <div class="item-title label">sets</div>',c=c+'      <div class="item-input">',c=c+'        <select data-item="sets">';for(i=1;11>i;i++)c+=
"          <option>"+i+"</option>";c+="        </select>";c+="      </div>";c+="    </div>";c+="  </div>";c+="</li>";console.log("\u0418\u0434\u0451\u0442 \u043f\u043e\u0441\u0442\u0440\u043e\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u044f \u0441 id = "+b);server.optionsExercises.query().filter("exerciseId",b).execute().then(function(a){console.log("\u0421\u043f\u0438\u0441\u043e\u043a \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a: "+
JSON.stringify(a));for(var b in a){var e=a[b];console.log("rowExOpt.option = "+e.option);"time"==e.option?(c+="<li>",c+='  <div class="item-content">',c+='    <div class="item-media"><i class="icon icon-form-settings"></i></div>',c+='    <div class="item-inner">',c+='      <div class="item-title label">'+e.option+"</div>",c+='      <div class="item-input">',c+='        <div class="row">',c+='          <div class="col-50"><input type="number" min="0" data-item="'+e.option+'-minutes" placeholder="Minutes"></div>',
c+='          <div class="col-50"><input type="number" min="0" data-item="'+e.option+'-seconds" placeholder="Seconds"></div>',c+="        </div>"):(c+="<li>",c+='  <div class="item-content">',c+='    <div class="item-media"><i class="icon icon-form-settings"></i></div>',c+='    <div class="item-inner">',c+='      <div class="item-title label">'+e.option+"</div>",c+='      <div class="item-input">',c+='        <input type="number" min="0" data-item="'+e.option+'" placeholder="Value of '+e.option+'">');
c+="      </div>";c+="    </div>";c+="  </div>";c+="</li>"}document.getElementById("ulListCurrentWorkEx").innerHTML=c})}
function saveExerciseWork(){var b=parseInt($$("span#spanCustName").data("item")),a=parseInt($$("#spanExWork").data("item")),c=$$("#spanDateEx").text(),d=parseInt($$('select[data-item="sets"]').val());server.workExercise.query().filter(function(k){return k.date==c&&k.exercise==a&&k.customer==b&&k.set==d}).execute().then(function(k){if(k.length)console.log("\u041f\u043e \u0442\u0435\u043a\u0443\u0449\u0435\u043c\u0443 \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u043c\u0443 \u0440\u0430\u0437\u0440\u0435\u0437\u0443 \u0443\u0436\u0435 \u0435\u0441\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435"),myApp.modal({title:i18n.gettext("Current set already exist in DB"),
text:i18n.gettext("What do you want to do with current values?"),buttons:[{text:i18n.gettext("Rewrite"),onClick:function(){var e=0;console.log("\u041c\u044b \u0432 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0435 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0438\u0441\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044e \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u044f");for(var l in k){var f=k[l];console.log("\u0412 \u0431\u0430\u0437\u0435 \u043d\u0430\u0448\u043b\u043e\u0441\u044c: item.option = "+
f.option+"; item.value = "+f.value);if("time"==f.option)var h=$$('#ulListCurrentWorkEx input[data-item = "time-minutes"]').val(),h=""==h?0:parseInt(h),g=$$('#ulListCurrentWorkEx input[data-item = "time-seconds"]').val(),h=(""==g?0:parseInt(g))+60*h;else h=$$('#ulListCurrentWorkEx input[data-item = "'+f.option+'"]').val(),h=""==h?0:parseInt(h);server.workExercise.update({id:parseInt(f.id),customer:b,date:c,exercise:a,option:f.option,value:h,set:d}).then(function(a){console.log("\u041e\u0431\u043d\u043e\u0432\u0438\u043b\u0438 \u043e\u0447\u0435\u0440\u0435\u0434\u043d\u0443\u044e \u0441\u0442\u0440\u043e\u043a\u0443 \u0432 \u0411\u0414: "+
JSON.stringify(a));e++;1==e&&myApp.addNotification({title:i18n.gettext("Data was saved"),hold:messageDelay,message:i18n.gettext("Data was updated")})})}}},{text:"Add",onClick:function(){var e=0,l;for(l in k){var f=k[l];if("time"==f.option)var h=$$('#ulListCurrentWorkEx input[data-item = "time-minutes"]').val(),h=""==h?0:parseInt(h),g=$$('#ulListCurrentWorkEx input[data-item = "time-seconds"]').val(),h=(""==g?0:parseInt(g))+60*h;else h=$$('#ulListCurrentWorkEx input[data-item = "'+f.option+'"]').val(),
h=""==h?0:parseInt(h);server.workExercise.update({id:parseInt(f.id),customer:b,date:c,exercise:a,option:f.option,value:h+f.value,set:d}).then(function(a){console.log("\u041e\u0431\u043d\u043e\u0432\u0438\u043b\u0438 \u043e\u0447\u0435\u0440\u0435\u0434\u043d\u0443\u044e \u0441\u0442\u0440\u043e\u043a\u0443 \u0432 \u0411\u0414 (\u0441\u043b\u043e\u0436\u0438\u043b\u0438 \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u0435\u043b\u0438): "+JSON.stringify(a));e++;1==e&&myApp.addNotification({title:i18n.gettext("Data was saved"),
hold:messageDelay,message:i18n.gettext("Data was updated")})})}}},{text:i18n.gettext("Cancel"),bold:!0,onClick:function(){}}]});else{console.log("\u041f\u043e \u0442\u0435\u043a\u0443\u0449\u0435\u043c\u0443 \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u043c\u0443 \u0440\u0430\u0437\u0440\u0435\u0437\u0443 \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e");var e="",f=0,g=0,l=0;$$("#ulListCurrentWorkEx li input").each(function(k,
q){console.log("item.value "+q.value+"; item.attributes[data-item].value "+q.attributes["data-item"].value);e=q.attributes["data-item"].value;if("time-minutes"===e){g=1;var n=$$(this).val(),n=""==n?0:parseInt(n);f+=60*n}else"time-seconds"===e?(g=1,n=$$(this).val(),n=""==n?0:parseInt(n),f+=n):(n=$$(this).val(),console.log("tempValue = "+n),n=""==n?0:parseInt(n),console.log("\u041f\u0435\u0440\u0435\u0434 \u0437\u0430\u043f\u0438\u0441\u044c\u044e: customerId = "+b+"; dateEx = "+c+"; exerciseId = "+
a+"; option = "+e+"; intValue = "+n+"; workSet = "+d),server.workExercise.add({customer:b,date:c,exercise:a,option:e,value:n,set:d}).then(function(a){console.log("\u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c, \u0447\u0442\u043e \u0437\u0430\u043f\u0438\u0441\u0430\u043b\u0438: "+JSON.stringify(a));l++;1==l&&myApp.addNotification({title:i18n.gettext("Data was saved"),hold:messageDelay,message:i18n.gettext("Data was added")})}))});g&&(console.log("\u0414\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u0432\u0440\u0435\u043c\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u044f \u0432 \u0431\u0430\u0437\u0443. time = "+
f),server.workExercise.add({customer:b,date:c,exercise:a,option:"time",value:f,set:d}).then(function(a){l++;1==l&&myApp.addNotification({title:i18n.gettext("Data was saved"),hold:messageDelay,message:i18n.gettext("Data was added")})}))}})}function makeCalDate(b){var a=b.getDate().toString(),c=1+b.getMonth();b=b.getFullYear().toString();2>a.length&&(a="0"+a);c=c.toString();2>c.length&&(c="0"+c);return b+"-"+c+"-"+a}
function makeCalendExCustomer(){var b="",b='<div class="col-25">'+('  <center><a href="#tab0" class="tab-link" onclick="viewExSetCustomer()">'+i18n.gettext("Cancel")+"</a></center>"),b=b+'</div><div class="col-25">',b=b+('  <center><a href="#tab1" class="tab-link active">'+i18n.gettext("Calendar")+"</a></center>"),b=b+"</div>",b=b+'<div class="col-25">',b=b+('  <center><a href="#tab2" class="tab-link" onclick="makeScheduleExCustomer()">'+i18n.gettext("Schedule")+"</a></center>"),b=b+"</div>",b=b+
'<div class="col-25">',b=b+('  <center><a href="#tab0" class="tab-link" onclick="saveSetExCustomer(\'fromCalendar\')">'+i18n.gettext("Save")+"</a></center>"),b=b+"</div>";document.getElementById("divMenuWorkout").innerHTML=b;$$("#ulListPastExercises").html("");console.log("\u041d\u0430\u0447\u0438\u043d\u0430\u0435\u043c \u043f\u043e\u0434\u0433\u0440\u0443\u0436\u0430\u0442\u044c \u043a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u044c");b=parseInt($$("span#spanCustName").data("item"));server.workout.query().filter("customer",
b).execute().then(function(a){var b=[],d="",k=0,e=[],f=$$("#spanDateEx").text(),g;for(g in a){var l=a[g],d=l.date;0==g?(b[0]=d,console.log("\u041f\u0435\u0440\u0432\u044b\u0439 \u0440\u0430\u0437. \u041d\u043e\u0432\u0430\u044f \u0434\u0430\u0442\u0430: "+d),k=1):in_array(d,b)?k+=1:(b[k]=d,k=1,console.log("\u041d\u043e\u0432\u0430\u044f \u0434\u0430\u0442\u0430: "+d));e[d]=1<k?e[d]+"@#"+l.exercise:l.exercise}if(a.length&&in_array(f,b)){console.log("\u041e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u043c \u0442\u0435\u043a\u0443\u0449\u0443\u044e \u0434\u0430\u0442\u0443 (\u043e\u043d\u0430 \u043d\u0430\u0448\u043b\u0430\u0441\u044c \u0432 \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u044b\u0445)!");
console.log("arrWorkEx[dateEx] = "+e[f]);a=e[f].split("@#");var m="";for(g in a)server.exercise.get(parseInt(a[g])).then(function(a){console.log("rowExercise.name = "+a.name);m+="<li>";m+='  <div class="item-link item-content">';m+='    <div class="item-inner">';m+='      <span data-item="'+a.id+'">'+a.name+"</span>";m+="    </div>";m+="  </div>";m+="</li>";document.getElementById("ulListPastExercises").innerHTML=m})}var q="January February March April May June July August September October November December".split(" ");
document.getElementById("calendar-inline-container").innerHTML="";console.log(b[0]);var n=myApp.calendar({container:"#calendar-inline-container",value:[new Date],weekHeader:!1,toolbarTemplate:'<div class="toolbar calendar-custom-toolbar"><div class="toolbar-inner"><div class="left"><a href="#" class="link icon-only"><i class="icon icon-back"></i></a></div><div class="center"></div><div class="right"><a href="#" class="link icon-only"><i class="icon icon-forward"></i></a></div></div></div>',onOpen:function(a){$$(".calendar-custom-toolbar .center").text(q[a.currentMonth]+
", "+a.currentYear);$$(".calendar-custom-toolbar .left .link").on("click",function(){n.prevMonth()});$$(".calendar-custom-toolbar .right .link").on("click",function(){n.nextMonth()})},onMonthAdd:function(a,d){$$(d).find(".picker-calendar-day").each(function(){var a=$$(this),d=a.attr("data-date").split("-"),e=makeCalDate(new Date(d[0],d[1],d[2]));console.log("dateText = "+e);in_array(e,b)&&(console.log("\u0421\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0435 \u0434\u0430\u0442\u044b \u043d\u0430\u0439\u0434\u0435\u043d\u043e: "+
d),a.addClass("selected-day"))})},onMonthYearChangeStart:function(a){$$(".calendar-custom-toolbar .center").text(q[a.currentMonth]+", "+a.currentYear)},onDayClick:function(a,d,l,f,k){console.log("\u041d\u0430\u0436\u0430\u043b\u0438 \u043d\u0430 \u0434\u0430\u0442\u0443 "+l+"-"+(parseInt(f)+1)+"-"+k);d=makeCalDate(new Date(l,f,k));if(in_array(d,b)){console.log("\u041d\u0430 \u044d\u0442\u0443 \u0434\u0430\u0442\u0443 \u0435\u0441\u0442\u044c \u043a\u043e\u043c\u043f\u043b\u0435\u043a\u0441 \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u0439!");
a=[];a=e[d].split("@#");var g="",m;for(m in a)d=a[m],console.log("\u041c\u044b \u0432 \u0446\u0438\u043a\u043b\u0435 \u043f\u043e \u043a\u043e\u0434\u0430\u043c \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u0439. \u0422\u0435\u043a\u0443\u0449\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430: "+d),server.exercise.get(parseInt(d)).then(function(a){g+="<li>";g+='  <div class="item-link item-content">';g+='    <div class="item-inner">';g+='      <span data-item="'+a.id+'">'+a.name+"</span>";
g+="    </div>";g+="  </div>";g+="</li>";console.log("listExCust = "+g);document.getElementById("ulListPastExercises").innerHTML=g;console.log("\u041e\u0431\u043d\u043e\u0432\u0438\u043b\u0438 \u043a\u043e\u043c\u043f\u043b\u0435\u043a\u0441 \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u0439!")})}}})})}
function makeScheduleExCustomer(){var b="",b='<div class="col-25">'+('  <center><a href="#tab0" class="back tab-link" onclick="viewExSetCustomer()">'+i18n.gettext("Cancel")+"</a>"),b=b+'</div><div class="col-25">',b=b+('  <center><a href="#tab1" class="tab-link" onclick="makeCalendExCustomer()">'+i18n.gettext("Calendar")+"</a></center>"),b=b+"</div>",b=b+'<div class="col-25">',b=b+('  <center><a href="#tab2" class="tab-link active">'+i18n.gettext("Schedule")+"</a></center>"),b=b+"</div>",b=b+'<div class="col-25">',
b=b+('  <center><a href="#tab0" class="tab-link" onclick="makeScheduleCustomer()">'+i18n.gettext("Save")+"</a></center>"),b=b+"</div>";document.getElementById("divMenuWorkout").innerHTML=b;b=parseInt($$("span#spanCustName").data("item"));$$("span#spanDateEx").text();var a=[];if($$("#ulListCurrentExercises li a div span")){var c="";$$("#ulListCurrentExercises li a div span").each(function(b,k){var e=k.innerHTML.replace(/<script[^>]*>[\S\s]*?<\/script[^>]*>/ig,""),f=parseInt($$(this).data("item"));
a.push(f);c+="<li>";c+='  <div class="item-link item-content">';c+='    <div class="item-inner">';c+='      <span data-item="'+f+'">'+e+"</span>";c+="    </div>";c+="  </div>";c+="</li>";document.getElementById("ulListScheduleEx").innerHTML=c});server.schedule.query("day").filter("customer",b).execute().then(function(b){var c=[],e=[],f=0,g=b.length;console.log("\u0420\u0430\u0437\u043c\u0435\u0440 \u043d\u0430\u0439\u0434\u0435\u043d\u043d\u043e\u0433\u043e \u043c\u0430\u0441\u0441\u0438\u0432\u0430 = "+
g);for(var l in b){var m=b[l];c[l]=m.day;console.log("\u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c \u0434\u0435\u043d\u044c "+m.day);console.log("index = "+l);f=parseInt(l)+1;console.log("num = "+f+"; count = "+g);0<l&&c[l]!=c[l-1]||f==g?(f==g&&(console.log("\u041d\u043e\u0432\u0430\u044f \u0437\u0430\u043f\u0438\u0441\u044c \u0442\u043e\u0433\u043e \u0436\u0435 \u0434\u043d\u044f (\u043f\u043e\u0441\u043b\u0435\u0434\u043d\u044f\u044f): "+m.exercise),e.push(m.exercise)),console.log("arrExForCheck.sort().toString() = "+
e.sort().toString()),console.log("arrWorkEx.sort().toString() = "+a.sort().toString()),console.log("\u0421\u0432\u0435\u0440\u044f\u0435\u043c \u043d\u0430\u0431\u043e\u0440\u044b \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u0439"),e.sort().toString()===a.sort().toString()&&(console.log("\u041e\u0442\u043c\u0435\u0447\u0430\u0435\u043c \u0441\u043e\u0432\u043f\u0430\u0432\u0448\u0438\u0439 \u0434\u0435\u043d\u044c "+c[l-1]),$$('#ulListDays li[data-item="'+c[l-1]+'"] input').prop("checked",
!0)),e.length=0):console.log("\u041d\u043e\u0432\u0430\u044f \u0437\u0430\u043f\u0438\u0441\u044c \u0442\u043e\u0433\u043e \u0436\u0435 \u0434\u043d\u044f: "+m.exercise);e.push(m.exercise)}})}}
function makeScheduleCustomer(){var b="",b='<div class="col-25">'+('  <center><a href="#tab0" class="back tab-link" onclick="viewExSetCustomer()">'+i18n.gettext("Cancel")+"</a>"),b=b+'</div><div class="col-25">',b=b+('  <center><a href="#tab1" class="tab-link" onclick="makeCalendExCustomer()">'+i18n.gettext("Calendar")+"</a></center>"),b=b+"</div>",b=b+'<div class="col-25">',b=b+('  <center><a href="#" class="tab-link">'+i18n.gettext("Schedule")+"</a></center>"),b=b+"</div>",b=b+'<div class="col-25">',
b=b+('  <center><a href="#tab3" class="tab-link" onclick="makeSetExCustomer()">'+i18n.gettext("Change")+"</a></center>"),b=b+"</div>";document.getElementById("divMenuWorkout").innerHTML=b;console.log("\u0421\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435");var a=parseInt($$("span#spanCustName").data("item")),c=0,d=[];$$("#ulListDays input:checked").each(function(a,b){d.push($$(this).val());console.log("$$(this).val() = "+$$(this).val());
"everyday"===$$(this).val()&&(c=1)});server.schedule.query().filter("customer",a).execute().then(function(b){for(var e in b){var f=b[e];(in_array(f.day,d)||c)&&server.remove("schedule",parseInt(f.id))}for(var g in d)$$("#ulListScheduleEx span").each(function(){var b=parseInt($$(this).data("item"));console.log("\u041f\u043e\u043b\u0443\u0447\u0438\u043b\u0438 id \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u044f: "+b);server.schedule.add({customer:a,
day:d[g],exercise:b});console.log("\u0411\u044b\u043b\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b \u0442\u0430\u043a\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0435: customer = "+a+"; day = "+d[g]+"; exerciseId = "+b)})})}
function viewExSetCustomer(){var b="",b='<div class="col-25">'+('  <center><a href="#view-10" class="back tab-link" id="aCancelSetEx">'+i18n.gettext("Cancel")+"</a>"),b=b+'</div><div class="col-25">',b=b+('  <center><a href="#tab1" class="tab-link" onclick="makeCalendExCustomer()">'+i18n.gettext("Calendar")+"</a></center>"),b=b+"</div>",b=b+'<div class="col-25">',b=b+('  <center><a href="#tab2" class="tab-link" onclick="makeScheduleExCustomer()">'+i18n.gettext("Schedule")+"</a></center>"),b=b+"</div>",
b=b+'<div class="col-25">',b=b+('  <center><a href="#tab3" class="tab-link" onclick="makeSetExCustomer()">'+i18n.gettext("Change")+"</a></center>"),b=b+"</div>";document.getElementById("divMenuWorkout").innerHTML=b}
$$("#ulListDays li").click(function(){console.log('$$(this).find("input").val() = '+$$(this).find("input").val());var b=$$(this).find("input").val();$$('#ulListDays input[value="'+b+'"]').prop("checked")&&("today"===b?($$('li[data-item="everyday"] input').prop("checked",!1),$$('li[data-item="week"] input').prop("checked",!1)):"everyday"==b?($$('li[data-item="today"] input').prop("checked",!1),$$('li[data-item="week"] input').prop("checked",!1)):($$('li[data-item="today"] input').prop("checked",!1),
$$('li[data-item="every"] input').prop("checked",!1)))});
function generateStatistics(){$$("#linkSaveWorkEx").show();var b=parseInt($$("span#spanCustName").data("item"));$$("span#spanDateEx").text();var a=parseInt($$("#spanExWork").data("item")),c=0;server.optionsExercises.query().filter("exerciseId",a).execute().then(function(d){var k=d.length;console.log("\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0432\u0441\u0435\u0445 \u0441\u043e\u0431\u0440\u0430\u043d\u043d\u044b\u0445 \u0438\u0437 \u0411\u0414 \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a: "+k);
var e;e='<span class="statistics-name">sets</span><br>';var f=0,g;for(g in d)e+='<span class="statistics-name">'+d[g].option+"</span><br>",f++,document.getElementById("divStatName").innerHTML=e;server.workExercise.query().filter(function(c){return c.exercise==a&&c.customer==b}).execute().then(function(a){console.log("\u041d\u0430\u0439\u0434\u0435\u043d\u043d\u044b\u0435 \u0431\u043b\u043e\u043a\u0438 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438: "+JSON.stringify(a));console.log("\u041d\u0430\u0439\u0434\u0435\u043d\u043e \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0437\u0430\u043f\u0438\u0441\u0435\u0439 \u043f\u043e \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u044e \u0438 \u043a\u043b\u0438\u0435\u043d\u0442\u0443: "+
a.length);var b=a.length/k;console.log("amountBlock =  "+b);c=5>b?b:5;console.log("\u041e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u043b\u0438 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u043c\u044b\u0445 \u0431\u043b\u043e\u043a\u043e\u0432 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438: "+c);var b="",d=0,e;for(e in a){var g=a[e];console.log("\u0412\u044b\u0432\u043e\u0434\u0438\u043c \u043f\u043e\u0441\u0442\u0440\u043e\u0447\u043d\u043e \u0432\u0441\u0451, \u0447\u0442\u043e \u043d\u0430\u0448\u043b\u043e\u0441\u044c: "+
JSON.stringify(g));console.log("\u0421\u0447\u0438\u0442\u0430\u0435\u043c \u0438\u0442\u0435\u0440\u0430\u0446\u0438\u0438: i = "+d);0===d&&(console.log("\u041e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u043c \u043d\u043e\u0432\u044b\u0439 \u0431\u043b\u043e\u043a"),b+='<div class="swiper-slide">',b+="<span>"+g.set+"</span>");b+="<br><span>"+g.value+"</span>";d++;d===f&&(console.log("\u0417\u0430\u043a\u0440\u044b\u0432\u0430\u0435\u043c \u0431\u043b\u043e\u043a \u0438 \u043e\u0431\u043d\u0443\u043b\u044f\u0435\u043c \u0441\u0447\u0451\u0442\u0447\u0438\u043a."),
b+="</div>",d=0);console.log("\u0412\u044b\u0432\u043e\u0434\u0438\u043c \u0431\u043b\u043e\u043a \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443.");document.getElementById("divStatistics").innerHTML=b}myApp.swiper(".swiper-stat",{freeMode:!0,spaceBetween:15,slidesPerView:c,grabCursor:!0,paginationHide:!1,paginationClickable:!0,nextButton:".swiper-button-next",prevButton:".swiper-button-prev"})})})}$$("#aWorkNote").on("click",function(){$$("#linkSaveWorkEx").show()});
$$("#aWorkStatistics").on("click",function(){$$("#linkSaveWorkEx").hide()});
$$("#aWorkGraph").on("click",function(){$$("#linkSaveWorkEx").hide();var b=parseInt($$("#spanExWork").data("item")),a=parseInt($$("#spanCustName").data("item")),c=[],d=0;server.optionsExercises.query().filter("exerciseId",b).execute().then(function(k){for(var e in k)c[e]=k[e].option;var f=c.length;console.log("\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0432\u0441\u0435\u0445 \u0441\u043e\u0431\u0440\u0430\u043d\u043d\u044b\u0445 \u0438\u0437 \u0411\u0414 \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a: "+f);
console.log("\u0421\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0441\u043e\u0431\u0440\u0430\u043d\u043d\u044b\u0445 \u0438\u0437 \u0411\u0414 \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a: "+JSON.stringify(c));server.workExercise.query().filter(function(c){return c.exercise===b&&c.customer===a}).execute().then(function(a){var b=0,c=[],e=[],k=[],h=[],r=[],s=[],t=[],u=[],v;for(v in a){var p=a[v];0===d&&(c[b]=p.date);console.log("item.option = "+p.option);
"repeats"===p.option?e[b]=p.value:"weight"===p.option?k[b]=p.value:"time"===p.option?h[b]=p.value/60:"distance"===p.option?r[b]=p.value:"speed"===p.option?s[b]=p.value:"slope"===p.option?t[b]=p.value:"load"===p.option&&(u[b]=p.value);d++;d===f&&(d=0,b++);console.log("\u041d\u043e\u043c\u0435\u0440 \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438 \u0432 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0438\u0442\u0435\u0440\u0430\u0446\u0438\u0438: "+d)}a={labels:c,
series:[{name:i18n.gettext("Repeats"),data:e},{name:i18n.gettext("Weight"),data:k},{name:i18n.gettext("Time"),data:h},{name:i18n.gettext("Distance"),date:r},{name:i18n.gettext("Speed"),data:s},{name:i18n.gettext("Slope"),data:t},{name:i18n.gettext("Load"),data:u}]};console.log("\u0421\u043e\u0431\u0438\u0440\u0430\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u043c\u0430\u0441\u0441\u0438\u0432\u044b \u0434\u043b\u044f \u043f\u043e\u043a\u0430\u0437\u0430 \u043d\u0430 \u0433\u0440\u0430\u0444\u0438\u043a\u0435.");
b={lineSmooth:Chartist.Interpolation.simple({divisor:2}),fullWidth:!0,chartPadding:{right:80}};console.log("\u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u043c \u0433\u0440\u0430\u0444\u0438\u043a.");new Chartist.Line(".ct-chart",a,b,[["screen and (max-width: 640px)",{seriesBarDistance:5,axisX:{labelInterpolationFnc:function(a){return a[0]}}}]]);$$(".ct-chart").on("click",".ct-point",function(a){a=$$(this);var b=a.attr("ct:value");a='<div class="popover"><div class="popover-inner"><div class="content-block"><p>'+
a.parent().attr("ct:series-name")+"</p><p>"+b+"</p></div></div></div>";myApp.popover(a,this)})})})});
